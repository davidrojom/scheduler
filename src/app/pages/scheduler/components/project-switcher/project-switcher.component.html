<div class="dropdown position-relative">
  <button
    class="btn btn-outline-light dropdown-toggle"
    type="button"
    (click)="toggleDropdown()"
    *ngIf="currentProject$ | async as currentProject"
    data-umami-event="toggle-project-dropdown"
  >
    {{ currentProject.name }}
  </button>

  <div
    class="dropdown-menu dropdown-menu-end"
    [class.show]="showDropdown"
    (click)="$event.stopPropagation()"
  >
    <h6 class="dropdown-header">Switch Project</h6>
    <div
      *ngFor="let project of projects$ | async"
      class="dropdown-item-wrapper"
    >
      <button
        class="dropdown-item"
        [class.active]="(currentProject$ | async)?.id === project.id"
        (click)="switchProject(project.id)"
        data-umami-event="switch-project"
      >
        <span class="project-name-wrapper">
          <span class="project-name-scroll" schScrollableText>{{
            project.name
          }}</span>
        </span>
        <button
          *ngIf="(projects$ | async)!.length > 1"
          class="btn btn-sm btn-link text-danger p-0 ms-2 delete-btn"
          (click)="deleteProject($event, project.id)"
          title="Delete project"
          data-umami-event="delete-project"
        >
          <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
            <path
              d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"
            />
            <path
              fill-rule="evenodd"
              d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"
            />
          </svg>
        </button>
      </button>
    </div>
    <div class="dropdown-divider"></div>
    <button class="dropdown-item text-primary" (click)="createNewProject()" data-umami-event="create-new-project">
      + New Project
    </button>
  </div>
</div>

<div
  *ngIf="showDropdown"
  class="dropdown-backdrop"
  (click)="showDropdown = false"
></div>
